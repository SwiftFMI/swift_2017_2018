## –ö–∞–∫–≤–æ –Ω–æ–≤–æ –≤ Swift 4, 4.1

### Swift 4
1.`String`:

–°–∏–º–≤–æ–ª–Ω–∏—Ç–µ –Ω–∏–∑–æ–≤–µ –≤ Swift –ø—Ä–µ—Ç—ä—Ä–ø—è–≤–∞—Ç –≥–æ–ª—è–º–∞ –ø—Ä–æ–º—è–Ω–∞ –≤ —Ç–∞–∑–∏ –æ—Å–Ω–æ–≤–Ω–∞ –≤–µ—Ä—Å–∏—è –Ω–∞ –µ–∑–∏–∫–∞. –í–µ—á–µ –µ –≤—ä–∑–º–æ–∂–Ω–æ –¥–∞ —Å–µ –∏—Ç–µ—Ä–∏—Ä–∞ –ø–æ –æ—Ç–¥–µ–ª–Ω–∏—Ç–µ —Å–∏–º–≤–æ–ª–∏ –Ω–∞ String, –±–µ–∑ –¥–∞ –µ –Ω—É–∂–Ω–æ –¥–∞ –º–∏–Ω–∞–≤–∞–º–µ –ø—Ä–µ–∑ characters –º–∞—Å–∏–≤–∞ (Array<Character>):

```swift
let city = "Sofia grad üôä"
for char in city {
    print(char)
}
```
–ù–µ —Å–∞–º–æ —Ç–æ–≤–∞, –Ω–æ –∏ –ø–æ–ª—É—á–∞–≤–∞–º–µ —Ç–∏–ø–∏—á–Ω–∏—Ç–µ –∑–∞ –∫–æ–ª–µ–∫—Ü–∏–∏—Ç–µ –∏ —Å–µ–∫—É–µ–Ω—Ç–Ω–∏—Ç–µ —Ç–∏–ø–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ (`Sequence` –∏ `Collection`):

```swift
city.count       // 12
city.isEmpty     // false
city.dropFirst() // "ofia grad üôä"
String(city.reversed()) // "üôä darg aifoS"

// –§–∏–ª—Ç—Ä–∏—Ä–∞–º–µ –≤—Å–∏—á–∫–∏ –Ω–µ-ASCII —Å–∏–º–≤–æ–ª–∏
city.filter { char in
    let isASCII = char.unicodeScalars.reduce(true, { $0 && $1.isASCII })
    return isASCII
} // "Sofia grad "
```

–î—Ä—É–≥–æ –≤–∞–∂–Ω–æ –¥–æ–ø—ä–ª–Ω–µ–Ω–∏–µ –µ `StringProtocol`. –¢—É–∫ —Å–∞ –¥–µ–∫–ª–∞—Ä–∏—Ä–∞–Ω–∏ –º–Ω–æ–≥–æ –æ—Ç —Ñ—É–Ω–∫—Ü–∏–∏—Ç–µ, –∫–æ–∏—Ç–æ –ø—Ä–µ–¥–∏ —Ç–æ–≤–∞ –±—è—Ö–∞ –≤ `String`. –ü—Ä–∏—á–∏–Ω–∞—Ç–∞ –∑–∞ —Ç–æ–≤–∞ –µ, –¥–∞ —Å–µ –ø–æ–¥–æ–±—Ä–∏ —Ä–∞–±–æ—Ç–∞—Ç–∞ —Å —á–∞—Å—Ç–∏ –æ—Ç —Å–∏–º–≤–æ–ª–Ω–∏—è –Ω–∏–∑ - slice. –î–æ–±–∞–≤–µ–Ω –µ –∏ —Ç–∏–ø–∞ `Substring`, –∫–æ–π—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–≤–∞ —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏—è –∫—ä–º —á–∞—Å—Ç –æ—Ç —Å–∏–º–≤–æ–ª–Ω–∏—è –Ω–∏–∑. –ò –¥–≤–∞—Ç–∞ —Ç–∏–ø–∞ - `String` –∏ `Substring` –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—Ç `StringProtocol` –ø—Ä–æ—Ç–æ–∫–æ–ª–∞, –∫–æ–µ—Ç–æ –∏–º –ø—Ä–∏–¥–∞–≤–∞ –ø–æ—á—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç:

```swift
// –í–∑–µ–º–∞–º–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –Ω–∞ String
let endIndex = city.index(city.startIndex, offsetBy: 4)
var sofiaSubstring = city[city.startIndex...endIndex]   // "Sofia"
type(of: sofiaSubstring)   // Substring.Type

// –ö–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä–∞–º–µ String –∫—ä–º Substring
sofiaSubstring += "üèô"     // "Sofiaüèô"

// Create a String from a Substring
let sofiaString = String(sofiaSubstring) // "Sofia üèô"
```

–°—ä—Å Swift 4 –≤–µ—á–µ —Å–µ –ø–æ–ª–∑–≤–∞ –∏ `Unicode 9`, –∫–æ–µ—Ç–æ —Ä–µ—à–∞–≤–∞ –∏ –ø—Ä–æ–±–ª–µ–º—ä—Ç —Å –≥—Ä–∞—Ñ–∏—á–Ω–∏—Ç–µ –µ–ª–µ–º–µ–Ω—Ç–∏ –≤ —Å–∏–º–≤–æ–ª–Ω–∏—Ç–µ –Ω–∏–∑–æ–≤–µ

```swift
"üë©‚Äçüíª".count // –°–µ–≥–∞: 1, –ü—Ä–µ–¥–∏: 2
"üëçüèΩ".count // –°–µ–≥–∞: 1, –ü—Ä–µ–¥–∏: 2
"üíë".count // –°–µ–≥–∞: 1, –ü—Ä–µ–¥–∏, 4
```
 
2.`Dictionary` –∏ `Set`:

–°—ä—Å Swift 4 —Ä–∞–±–æ—Ç–∞—Ç–∞ —Å —Ç–µ–∑–∏ –¥–≤–µ –∫–æ–ª–µ–∫—Ü–∏–∏ —Å—Ç–∞–≤–∞ –ø–æ-–∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–∞.
–í—ä–≤–µ–¥–µ–Ω–∞ –µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç —Å–µ–∫—É–µ–Ω—Ç–µ–Ω —Ç–∏–ø (Sequence Based Initialization)

```swift
let nearCities = ["Pernik", "Botevgrad", "Svoge"]
let nearCitiesDistances: [Float] = [35.2, 64.1, 46.8]

let citiesDict = Dictionary(uniqueKeysWithValues: zip(nearCities, nearCitiesDistances))
// ["Botevgrad": 64.1, "Pernik": 35.2, "Svoge": 46.8]
```

–†–∞–∑—Ä–µ—à–∞–≤–∞–Ω–µ –Ω–∞ –¥–µ–±–ª–∏—Ü–∏—Ä–∞–Ω–∏ –∫–ª—é—á–æ–≤–µ. –°—ä—Å Swift 4 –Ω–∏–µ –¥–∞–¥–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª –Ω–∞–¥ –ø–æ–≤–µ–¥–µ–Ω–∏–µ—Ç–æ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è—Ç–∞ —Å –¥—É–±–ª–∏—Ü–∏—Ä–∞–Ω–∏ –∫–ª—é—á–æ–≤–µ:

```swift
// –ì–ª–∞—Å—É–≤–∞–Ω–µ –∑–∞ –ª—é–±–∏–º–∏ –±–ª–∏–∑–∫–∏ –Ω–∞ –°–æ—Ñ–∏—è –≥—Ä–∞–¥–æ–≤–µ
let favoriteCities = ["Pernik", "Botevgrad", "Pernik", "Svoge"]

// –ö–æ–Ω—Ñ–ª–∏–∫—Ç–∏—Ç–µ –ø—Ä–∏ –¥—É–±–ª–∏—Ä–∞–Ω–µ –Ω–∞ –∫–ª—é—á–æ–≤–µ—Ç–µ —Å–µ —Ä–∞–∑—Ä–µ—à–∞–≤–∞—Ç —á—Ä–µ–∑ –∫–ª–æ—É–∂—ä—Ä
let mergedKeysAndValues = Dictionary(zip(favoriteCities, repeatElement(1, count: favoriteCities.count)), uniquingKeysWith: +) // ["Botevgrad": 1, "Pernik": 2, "Svoge": 1]
// –ò–∑–ø–æ–ª–∑–≤–∞–º–µ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ zip –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ +, –∑–∞ –¥–∞ —Ä–∞–∑—Ä–µ—à–∏–º –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∏—Ç–µ
```

–î–æ–±–∞–≤–µ–Ω–∞ –µ –∏ –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç—Ç–∞ –∑–∞ —Ñ–∏–ª—Ç—Ä–∏—Ä–∞–Ω–µ –Ω–∞ `Dictionary` –∏ `Set`:

```swift
// –†–µ–∑—É–ª—Ç–∞—Ç—ä—Ç –æ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ç —Ñ–∏–ª—Ç—ä—Ä –µ –¥—Ä—É–≥–æ Dictionary, –∞ –Ω–µ –º–∞—Å–∏–≤ –æ—Ç n-—Ç–æ—Ä–∫–∏
let closeCities = citiesDict.filter { $0.value < 40 }
closeCities // Dictionary: ["Pernik": 35.2]
``` 

Dictionary mapping (–≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç –¥–∞ —Ç—Ä–∞—Å–Ω—Ñ–æ—Ä–º–∏—Ä–∞–º–µ —Å–∞–º–æ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏—Ç–µ –Ω–∞ –µ–¥–Ω–æ Dictionary):

```swift
let mappedCloseCities = closeCities.mapValues { "\($0)" }
mappedCloseCities // ["Pernik": "35.2"]
```

3.–ê—Ä—Ö–∏–≤–∏—Ä–∞–Ω–µ –∏ –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è:

–ü—Ä–µ–¥–∏ Swift 4, –∑–∞ –¥–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–∏—Ä–∞–º–µ –Ω—è–∫–æ–π –æ–±–µ–∫—Ç, —Ç–æ–π —Ç—Ä—è–±–≤–∞—à–µ –¥–∞ –µ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫ –Ω–∞ `NSObject` (Objective-C –∫–ª–∞—Å) –∏ –¥–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞ `NSCoding` –ø—Ä–æ—Ç–æ–∫–æ–ª–∞, –∞ –∑–∞ —Ç–∏–ø–æ–≤–µ –∫–∞—Ç–æ `struct` –∏ `enum` —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞—Ö–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ —Ö–∞–∫–æ–≤–µ.
–í Swift 4 –µ –¥–æ–±–∞–≤–µ–Ω–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –≤—Å–∏—á–∫–∏ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏ —Ç–∏–ø–æ–≤–µ - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏, –∏–∑–±–æ—Ä–µ–Ω–∏ —Ç–∏–ø–æ–≤–µ –∏ –∫–ª–∞—Å–æ–≤–µ.

```swift
struct FoodLog: Codable {
    enum Food: String, Codable {
        case doner, pizza, tarator
    }
    
    var day: Int
    var eaten: [Food]
}

// –°—ä—Å—Ç–∞–≤—è–º–µ —Å–∏ –¥–Ω–µ–≤–Ω–∏–∫ –æ—Ç —Ö—Ä–∞–Ω–∏
let log = FoodLog(day: 1, eaten: [.doner, .tarator])
```

–û—Ç –≥–æ—Ä–Ω–∏—è –ø—Ä–∏–º–µ—Ä –≤–∏–∂–¥–∞–º–µ, —á–µ –∑–∞ –¥–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–º–µ `Encodable` –∏ `Decoadable` –ø—Ä–æ—Ç–æ–∫–æ–ª–∏—Ç–µ –µ –Ω—É–∂–Ω–æ –≤—Å–∏—á–∫–∏ —á–ª–µ–Ω –¥–∞–Ω–Ω–∏ –Ω–∞ —Ç–∏–ø–∞ –¥–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—Ç —Ç–µ–∑–∏ –¥–≤–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞. –ò–º–µ–Ω–Ω–æ —á—Ä–µ–∑ —Ç–µ–∑–∏ –¥–≤–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –º–æ–∂–µ–º –¥–∞ –∞—Ä—Ö–∏–≤–∏—Ä–∞–º–µ –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∏—Ä–∞–º–µ –Ω–∞—à–∏—Ç–µ —Ç–∏–ø–æ–≤–µ. –°–∞–º–∞—Ç–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ –∏–∑–≤—ä—Ä—à–≤–∞ –æ—Ç –æ–±–µ–∫—Ç –æ—Ç —Ç–∏–ø `JSONEncoder`. –¢–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–µ—Ä–∏–∞–ª–∏–∑–∏—Ä–∞ –Ω–∞—à–∏—è –æ–±–µ–∫—Ç –≤ JSON –æ–±–µ–∫—Ç.


```swift
import Foundation 

let jsonEncoder = JSONEncoder() // –ï–¥–∏–Ω –æ—Ç –≤–≥—Ä–∞–¥–µ–Ω–∏—Ç–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∏

// –°–µ—Ä–∏–∞–ª–∏–∑–∏—Ä–∞–º–µ –¥–∞–Ω–Ω–∏—Ç–µ
let jsonData = try jsonEncoder.encode(log)
// –°—ä–∑–¥–∞–≤–∞–º–µ —Å–∏–º–≤–æ–ª–µ–Ω –Ω–∏–∑ –æ—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–∏—Ä–∞–Ω–∏—Ç–µ –¥–∞–Ω–Ω–∏
let jsonString = String(data: jsonData, encoding: .utf8) // "{"day":1,"eaten":["doner","tarator"]}"
```

–û–±—Ä–∞—Ç–Ω–∏—è –ø—Ä–æ—Ü–µ—Å - –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ –∏–∑–≤—ä—Ä—à–≤–∞ –æ—Ç `JSONDecoder` –∫–ª–∞—Å–∞.

```swift
let jsonDecoder = JSONDecoder() // –ü—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–∏—è—Ç –ø–æ—Ü–µ—Å –Ω–∞ JSONEncoder

// –û–ø–∏—Ç–≤–∞–º–µ —Å–µ –¥–∞ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∏—Ä–∞–º–µ –¥–∞–Ω–Ω–∏—Ç–µ –æ—Ç –ø–æ-–≥–æ—Ä–µ
let decodedLog = try jsonDecoder.decode(FoodLog.self, from: jsonData)
decodedLog.day         // 1
decodedLog.eaten // [doner, tarator]
```

4.Key-Value Coding:

–í Swift –º–æ–∂–µ–º –¥–∞ –¥—ä—Ä–∂–∏–º —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏—è –∫—ä–º —Ñ—É–∫–Ω—Ü–∏—è, –±–µ–∑ –¥–∞ —è –∏–∑–≤–∏–∫–≤–∞–º–µ, –∑–∞—â–æ—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏—Ç–µ —Å–∞–º–∏ –ø–æ —Å–µ–±–µ —Å–∏ —Å–∞ –∫–ª–æ—É–∂—ä—Ä–∏. –ù–æ –ø—Ä–µ–¥–∏ Swift 4 –Ω–µ –º–æ–∂–µ—Ö–º–µ –¥–∞ –¥—ä—Ä–∂–∏–º —Ç–∞–∫–∞–≤–∞ —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏—è –∏ –∑–∞ —á–ª–µ–Ω –¥–∞–Ω–Ω–∏—Ç–µ –Ω–∞ —Ç–∏–ø–æ–≤–µ—Ç–µ (–¥–∞ –∏–º–∞–º–µ —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏—è, –±–µ–∑ –¥–∞ –¥–æ—Å—Ç—ä–ø–≤–∞–º–µ —Å—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ —Ç–∞–∑–∏ —á–ª–µ–Ω –¥–∞–Ω–Ω–∞ - key path/–∫–ª—é—á–æ–≤ –ø—ä—Ç). –ù–æ–≤–æ—Ç–æ –ø–æ–ø—ä–ª–Ω–µ–Ω–∏–µ –≤ Swift 4 –Ω–∏ –¥–∞–≤–∞ —Ç–æ—á–Ω–æ —Ç–∞–∫–∞–≤–∞ –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç.

```swift
struct Lightsaber {
  enum Color {
    case blue, green, red
  }
  let color: Color
}

class ForceUser {
  var name: String
  var lightsaber: Lightsaber
  var master: ForceUser?

  init(name: String, lightsaber: Lightsaber, master: ForceUser? = nil) {
    self.name = name
    self.lightsaber = lightsaber
    self.master = master
  }
}

let sidious = ForceUser(name: "–î–∞—Ä—Ç –°–∏–¥–∏—É—Å", lightsaber: Lightsaber(color: .red))
let obiwan = ForceUser(name: "–û–±–∏-–£–∞–Ω –ö–µ–Ω–æ–±–∏", lightsaber: Lightsaber(color: .blue))
let anakin = ForceUser(name: "–ê–Ω–∞–∫–∏–Ω –°–∫–∞–π—É–æ–∫—ä—Ä", lightsaber: Lightsaber(color: .blue), master: obiwan)
```

–¢—É–∫ —Å—ä–∑–¥–∞–≤–∞–º–µ –∏–Ω—Å—Ç–∞–Ω—Ü–∏–∏ –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω–∏ –≥–µ—Ä–æ–∏, –∏–∑–ø–æ–ª–∑–≤–∞—â–∏ "–°–∏–ª–∞—Ç–∞", —Å —Ç–µ—Ö–Ω–∏—Ç–µ –∏–º–µ–Ω–∞, –º–µ—á–æ–≤–µ –∏ —É—á–∏—Ç–µ–ª–∏. –ó–∞ –¥–∞ —Å–∏ —Å—ä–∑–¥–∞–¥–µ–º –∫–ª—é—á–æ–≤ –ø—ä—Ç, –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –æ–±—ä—Ä–Ω–∞—Ç–∞ –Ω–∞–∫–ª–æ–Ω–µ–Ω–∞ —á–µ—Ä—Ç–∞, –ø–æ—Å–ª–µ–¥–≤–∞–Ω–∞ –æ—Ç –∏–º–µ—Ç–æ –Ω–∞ —á–ª–µ–Ω –¥–∞–Ω–Ω–∞—Ç–∞, –∫–æ—è—Ç–æ –Ω–∏ –∏–Ω—Ç–µ—Ä–µ—Å—É–≤–∞:

```swift
// –°—ä–∑–¥–∞–≤–∞–º–µ —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏—è –∫—ä–º –∏–º–µ—Ç–æ –Ω–∞ —á–ª–µ–Ω –¥–∞–Ω–Ω–∞—Ç–∞ ForceUser.name —á—Ä–µ–∑ –∫–ª—é—á–æ–≤ –ø—ä—Ç
let nameKeyPath = \ForceUser.name

// –î–æ—Å—Ç—ä–ø–≤–∞–º–µ —Å—Ç–æ–π–Ω–æ—Å—Ç—Ç–∞ –Ω–∞ —Ç–æ–≤–∞ –ø–æ–ª–µ
let obiwanName = obiwan[keyPath: nameKeyPath]  // "–û–±–∏-–£–∞–Ω –ö–µ–Ω–æ–±–∏"
```

–¢—É–∫ —Å—ä–∑–¥–∞–≤–∞–º–µ –∫–ª—é—á–æ–≤ –ø—ä—Ç –∫—ä–º –ø–æ–ª–µ—Ç–æ `name` –Ω–∞ —Ç–∏–ø–∞ `ForceUser`, —Å–ª–µ–¥ —Ç–æ–≤–∞ –≥–æ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ —á—Ä–µ–∑ –Ω–æ–≤–∏—è –∫—Ä–∞—Ç—ä–∫ –¥–æ—Å—Ç—ä–ø(subscript) - `[keyPath: ...]`. –û—â–µ –Ω—è–∫–æ–ª–∫–æ –ø—Ä–∏–º–µ—Ä–∞ –∫–∞–∫ –º–æ–∂–µ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –∫–ª—é—á–æ–≤–∏—è –ø—ä—Ç:

```swift
// –ò–∑–ø–æ–ª–∑–≤–∞–º–µ –¥–∏—Ä–µ–∫—Ç–Ω–æ –∫–ª—é—á–æ–≤ –ø—ä—Ç –¥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ —á–ª–µ–Ω –¥–∞–Ω–Ω–∞ –Ω–∞ –≤–ª–æ–∂–µ–Ω —Ç–∏–ø
let anakinSaberColor = anakin[keyPath: \ForceUser.lightsaber.color]  // blue

// –î–æ—Å—Ç—ä–ø–∞–º–µ —á–ª–µ–Ω –¥–∞–Ω–Ω–∞ –Ω–∞ –æ–±–µ–∫—Ç, –≤—ä—Ä–Ω–∞—Ç –æ—Ç –∫—Ä–∞—Ç–∫–∏—è –¥–æ—Å—Ç—ä–ø —á—Ä–µ–∑ –∫–ª—é—á–æ–≤ —Ç–∏–ø
let masterKeyPath = \ForceUser.master
let anakinMasterName = anakin[keyPath: masterKeyPath]?.name  // "–û–±–∏-–£–∞–Ω –ö–µ–Ω–æ–±–∏"

// –ú–æ–∂–µ–º –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ —Å–µ—Ç—ä—Ä —á—Ä–µ–∑ –∫–ª—é—á–æ–≤ –ø—ä—Ç –∏ –ê–Ω–∞–∫–∏–Ω –¥–∞ –ø—Ä–µ–º–∏–Ω–µ –∫—ä–º —Ç—ä–º–Ω–∞—Ç–∞ —Å—Ç—Ä–∞–Ω–∞
anakin[keyPath: masterKeyPath] = sidious
anakin.master?.name // –î–∞—Ä—Ç –°–∏–¥–∏—É—Å
```

5.–ï–¥–Ω–æ—Å—Ç—Ä–∞–Ω–Ω–∏ –æ–±—Ö–≤–∞—Ç–∏ (range):

–õ–µ—Å–µ–Ω –Ω–∞—á–∏–Ω –∑–∞ —Å—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –æ–±—Ö–≤–∞—Ç–∏ —Å –∏–Ω–¥–µ–∫—Å –¥–æ –∫—Ä–∞—è –∏–ª–∏ –Ω–∞—á–∞–ª–æ—Ç–æ –Ω–∞ –ø–æ—Ä–µ–¥–∏—Ü–∞.
```
let cities = ["Sofia", "Plovdiv", "Varna", "Burgas", "Vratsa", "Vidin", "Ruse", "Pleven", "Gabrovo"]

let smaller = cities[4...] // ["Vratsa", "Vidin", "Ruse", "Pleven", "Gabrovo"]
let topThree = cities[..<3] // ["Sofia", "Plovdiv", "Varna"]
```

### Swift 4.1

1.–°–∏–Ω—Ç–µ–∑–∏—Ä–∞–Ω–∏ `Equatable` –∏ `Hashable`:

Equatable –Ω–∏ —Å–ª—É–∂–∏ –∑–∞ —Å—Ä–∞–≤–Ω—è–≤–∞–Ω–µ –Ω–∞ –¥–≤–∞ –æ–±–µ–∫—Ç–∞, –Ω–æ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω–µ—Ç–æ –º—É –Ω–∞ —Ä—ä–∫–∞ –∑–∞ –æ–±–µ–∫—Ç–∏ —Å –º–Ω–æ–≥–æ –ø–æ–ª–µ—Ç–∞ –º–æ–∂–µ –¥–∞ –µ –∏–∑–º–æ—Ä–∏—Ç–µ–ª–Ω–æ. –ï—Ç–æ –∑–∞—â–æ –≤ Swift 4.1 –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è—Ç–∞ –Ω–∞ Eqatable –µ —Å–∏–Ω—Ç–µ–∑–∏—Ä–∞–Ω–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω–∞), —Å—Ç–∏–≥–∞ –≤—Å–∏—á–∫–∏ —á–ª–µ–Ω –¥–∞–Ω–Ω–∏ –¥–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ Equatable:

```swift
struct Person: Equatable {
    var firstName: String
    var lastName: String
    var age: Int
    var city: String
    
    static func ==(lhs: Person, rhs: Person) -> Bool {
        return lhs.firstName == rhs.firstName && lhs.lastName == rhs.lastName && lhs.age == rhs.age && lhs.city == rhs.city
    }
}
```

–í Swift 4.1 —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ == –µ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∞ –∑–∞ –Ω–∞—Å –∏ –∫–æ–¥—ä—Ç –æ—Å—Ç–∞–≤–∞ –∫—Ä–∞—Ç—ä–∫ –∏ —á–µ—Ç–∏–º

```swift
struct Person: Equatable {
    var firstName: String
    var lastName: String
    var age: Int
    var city: String
}
```

–†–∞–∑–±–∏—Ä–∞ —Å–µ, –≤—Å–µ –æ—â–µ –∏–º–∞–º–µ –≤—ä–∑–º–æ–∂–Ω–æ—Å—Ç –¥–∞ –ø—Ä–µ–¥–µ—Ñ–∏–Ω–∏—Ä–∞–º–µ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ ==, –∞–∫–æ –∏–º–∞–º–µ —É–Ω–∏–∫–∞–ª–Ω–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç –∫–∞—Ç–æ id –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –∫–æ—è—Ç–æ –∏—Å–∫–∞–º–µ –¥–∞ —Å—Ä–∞–≤–Ω—è–≤–∞–º–µ –¥–≤–∞ –æ–±–µ–∫—Ç–∞.

–ü–æ —Å—ä—â–∏—è –Ω–∞—á–∏ –µ –∏–Ω—Ç–µ–∑–∏—Ä–∞–Ω–∞ –∏ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è—Ç–∞ –Ω–∞ `Hashable` –ø—Ä–æ—Ç–æ–∫–æ–ª–∞. –ü—Ä–µ–¥–∏ —Ç—Ä—è–±–≤–∞—à–µ –¥–∞ –ø–∏—à–µ–º:

```swift
var hashValue: Int {
    return firstName.hashValue ^ lastName.hashValue &* 16777619
}
```

2.–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∑–∞ (–¥–µ)—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è:

–ß–µ—Å—Ç–æ —Å—Ä–µ—â–∞–Ω –ø—Ä–æ–±–ª–µ–º –≤ Swift 4.0 –±–µ—à–µ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è—Ç–∞ –Ω–∞ JSON, –∫–æ–π—Ç–æ –ø–æ–ª–∑–≤–∞ snake_case –∑–∞ –∏–º–µ–Ω–∞—Ç–∞ –Ω–∞ –∫–ª—é—á–æ–≤–µ—Ç–µ, –≤–º–µ—Å—Ç–æ —Ç–∏–ø–∏—á–Ω–∏—è –∑–∞ Swift camelCase. Codable –Ω—è–º–∞—à–µ –Ω–∞—á–∏–Ω –¥–∞ —Ä–∞–∑–±–µ—Ä–µ –∫–∞–∫ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–∞ –Ω–∞–ø–∞—Å–Ω–∞—Ç–∏ –∏–º–µ–Ω–∞—Ç–∞ –Ω–∞ –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∏—Ç–µ –∏ –∑–∞—Ç–æ–≤–µ —Å–µ –Ω–∞–ª–∞–≥–∞—à–µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω–µ—Ç–æ –Ω–∞ –∏–∑–±—Ä–æ–µ–Ω–∏—è —Ç–∏–ø `CodingKeys`, –∫–æ–π—Ç–æ –¥–∞ –ø–æ–º–æ–≥–Ω–µ. –í Swift 4.1 –µ –¥–æ–±–∞–≤–µ–Ω–æ –ø–æ–ª–µ `keyDecodingStrategy`, —á–∏—è—Ç–æ —Å—Ç–æ–π–Ω–æ—Å—Ç –ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ –µ `.useDefaultKeys`, –Ω–æ –∑–∞ –¥–∞ —Ä–µ—à–∏–º —á–µ—Å—Ç–æ —Å—Ä–µ—â–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º –ø–æ-–≥–æ—Ä–µ –º–æ–∂–µ–º –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ `.convertFromSnakeCase` –∏ Coable —â–µ —Å–µ –ø–æ–≥—Ä–∏–∂–∏ –∑–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—è—Ç–∞ –Ω–∞ –∫–ª—é—á–æ–≤–µ—Ç–µ –≤–º–µ—Å—Ç–æ –Ω–∞—Å:

```swift
let jsonString = """
[
    {
        "name": "MacBook Pro",
        "screen_size": 15,
        "cpu_count": 4
    },
    {
        "name": "iMac Pro",
        "screen_size": 27,
        "cpu_count": 18
    }
]

struct Mac: Codable {
    var name: String
    var screenSize: Int
    var cpuCount: Int
}
"""

let jsonData = Data(jsonString.utf8)

let decoder = JSONDecoder()

do { // –í–∏–Ω–∞–≥–∏ —â–µ —Å–µ –≤—Ä—ä—â–∞ –≥—Ä–µ—à–∫–∞, –∑–∞—â–æ—Ç–æ –Ω—è–º–∞ —Å—ä–≤–ø–∞–¥–µ–Ω–∏–µ –≤—ä–≤ —Ñ–æ—Ä–º–∞—Ç–∞ –Ω–∞ –∫–ª—é—á–æ–≤–µ—Ç–µ
    let macs = try decoder.decode([Mac].self, from: jsonData)
    print(macs)
} catch {
    print(error.localizedDescription)
}

```

```swift
let decoder = JSONDecoder()

do { // –ü—Ä–∞–≤–∏–ª–Ω–æ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∏—Ä–∞–º–µ JSON –æ–±–µ–∫—Ç–∞, –∑–∞—â–æ—Ç–æ –ø—Ä–∏–ª–∞–≥–∞–º–µ –ø–æ–¥—Ö–æ–¥—è—â–∞—Ç–∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è .convertFromSnakeCase
    let macs = try decoder.decode([Mac].self, from: jsonData)
    decoder.keyDecodingStrategy = .convertFromSnakeCase
    print(macs)
} catch {
    print(error.localizedDescription)
}
```

–ü—Ä–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–º JSON –º–æ–∂–µ–º –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞–º–µ `.convertToSnakeCase` –ø–æ —Å–ª–µ–¥–Ω–∏—è –Ω–∞—á–∏–Ω:

```swift
let encoder = JSONEncoder()
encoder.keyEncodingStrategy = .convertToSnakeCase
let encoded = try encoder.encode(someObject)
```

3.Conditional conformance:

–í Swift 4.1 –º–æ–∂–µ–º –¥–∞ —É–∫–∞–∑–≤–∞–º–µ, —á–µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–º–µ –ø—Ä–æ—Ç–æ–∫–æ–ª —Å–∞–º–æ –∞–∫–æ –¥–∞–¥–µ–Ω–∏ —É—Å–ª–æ–≤–∏—è —Å–∞ –∏–∑–ø—ä–ª–Ω–µ–Ω–∏. –ó–∞ —Ü–µ–ª—Ç–∞ —â–µ –¥–µ—Ñ–∏–Ω–∏—Ä–∞–º–µ –ø—Ä–æ–∫–æ—Ç–æ–ª `Purchaseable`, –∫–æ–π—Ç–æ —Ä–∞–∑–ª–∏—á–Ω–∏ —Å—Ç–æ–∫–∏ —â–µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—Ç:

```swift
protocol Purchaseable {
   func buy()
}

struct Book: Purchaseable {
   func buy() {
      print("–í–∏–µ —Å–∏ –∫—É–ø–∏—Ö—Ç–µ –∫–Ω–∏–≥–∞.")
   }
}
```

–ö–æ–≥–∞—Ç–æ –æ–±–∞—á–µ –∏–º–∞–º–µ —Ü—è–ª–∞ "–∫–æ—à–Ω–∏—Ü–∞" —Å–∞ —Ç–∞–∫–∏–≤–∞ —Å—Ç–æ–∫–∏, –∫–æ–∏—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—è—Ç –±–∏ –∏—Å–∫–∞–ª –¥–∞ –∫—É–ø–∏ –º–æ–∂–µ–º –¥–∞ –∏—Ç–µ—Ä–∏—Ä–∞–º–µ –ø–æ —Ü–µ–ª–∏—è —Å–ø–∏—Å—ä–∫ —Å—ä—Å —Å—Ç–æ–∫–∏ –∏ –¥–∞ –∏–∑–≤–∏–∫–∞–º–µ —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ `buy`, –Ω–æ –ø–æ-–¥–æ–±—ä—Ä –ø–æ–¥—Ö–æ–¥ –±–∏ –±–∏–ª –¥–∞ –Ω–∞–ø—Ä–∞–≤–∏–º —Ä–∞–∑—à–∏—Ä–µ–Ω–∏–µ –Ω–∞ Array, –∫–æ–µ—Ç–æ –¥–∞ –∏–º–∞ —Ñ—É–Ω–∫—Ü–∏—è `buy` —Å–∞–º–æ –∫–æ–≥–∞—Ç–æ –≤—Å–∏—á–∫–∏ –µ–ª–µ–º–µ–Ω—Ç–∏ –≤ –º–∞—Å–∏–≤–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞—Ç –ø—Ä–æ–∫–æ–ª–∞ `Purchaseable`:

```swift
extension Array: Purchaseable where Element: Purchaseable {
   func buy() {
      for item in self {
         item.buy()
      }
   }
}
```

4.–†–µ–∫—É—Ä—Å–∏–≤–Ω–∏ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è –∫—ä–º –∞—Å–æ—Ü–∏–∏—Ä–∞–Ω–∏—Ç–µ —Ç–∏–ø–æ–≤–µ:

Swift 4.1 –æ–±–ª–µ–∫—á–∞–≤–∞ —Ä–µ—Å—Ç—Ä–∏–∫—Ü–∏–∏—Ç–µ, –∫–æ–∏—Ç–æ –±—è—Ö–∞ —Å–≤—ä—Ä–∑–∞–Ω–∏ —Å –∞—Å–æ—Ü–∏–∏—Ä–∞–Ω–∏—Ç–µ —Ç–∏–ø–æ–≤–µ –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏—Ç–µ. –í —Ä–µ–∑—É–ª—Ç–∞—Ç –Ω–∞ —Ç–æ–≤–∞ –º–æ–∂–µ–º –¥–∞ –¥–µ—Ñ–∏–Ω–∏—Ä–∞–º–µ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏ –∞—Å–æ—Ü–∏–∞—Ü–∏–∏ –Ω–∞ —Ç–∏–ø–æ–≤–µ –≤ –ø—Ä–æ—Ç–æ–∫–æ–ª–∏—Ç–µ, –≤ –∫–æ–∏—Ç–æ —Ç–µ —Å–∞ –¥–µ—Ñ–∏–Ω–∏—Ä–∞–Ω–∏. –ï–¥–∏–Ω –ø—Ä–∏–º–µ—Ä –∑–∞ —Ç–∞–∫–∞–≤–∞ —Ä–µ–∫—É—Ä—Å–∏—è –µ –µ–∫–∏–ø –æ—Ç —Å–ª—É–∂–∏—Ç–µ–ª–∏ –≤ –∫–æ–º–ø–∞–Ω–∏—è, –∫–∞—Ç–æ –≤—Å–µ–∫–∏ —Å–ª—É–∂–∏—Ç–µ–ª –º–æ–∂–µ –¥–∞ –∏–º–∞ –ø–æ-–≤–∏—Å—à–µ—Å—Ç–æ—è—â (–∏–∑–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏—è—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä –Ω–∞–ø—Ä–∏–º–µ—Ä –Ω—è–º–∞ –ø—Ä—è–∫ –º–µ–Ω–∏–¥–∂—ä—Ä), –∫–∞—Ç–æ –≤—Å–µ–∫–∏ –≤–∏—Å—à–µ—Å—Ç–æ—è—â —Ç—Ä—è–±–≤–∞ —Å–∞–º –ø–æ —Å–µ–±–µ —Å–∏ –¥–∞ –±—ä–¥–µ —Å–ª—É–∂–∏—Ç–µ–ª –Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è—Ç–∞:

```swift
protocol Employee {
   associatedtype Manager: Employee
   var manager: Manager? { get set }
}
```

–í—ä–ø—Ä–µ–∫–∏, —á–µ —Ä–µ–ª–∞—Ü–∏—è—Ç–∞ –µ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–∞, —Ç–æ–≤–∞ –Ω–µ –±–µ—à–µ –≤—ä–∑–º–æ–∂–Ω–æ –≤ Swift 4.0. –ë–ª–∞–≥–æ–¥–∞—Ä–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏—Ç–µ –∞—Å–æ—Ü–∏–∏—Ä–∞–Ω–∏ —Ç–∏–ø–æ–≤–µ, –º–æ–∂–µ–º –¥–∞ –¥–µ—Ñ–∏–Ω–∏—Ä–∞–º–µ —Å–ª–µ–¥–Ω–∞—Ç–∞ –π–µ—Ä–∞—Ä—Ö–∏—è:

```swift
class BoardMember: Employee {
   var manager: BoardMember?
}

class SeniorDeveloper: Employee {
   var manager: BoardMember?
}

class JuniorDeveloper: Employee {
   var manager: SeniorDeveloper?
}
```

5.`flatMap` -> `compactMap`:

`flatMap` —Ñ—É–Ω–∫—Ü–∏—è—Ç–∞ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–ª—É—á–∞–∏, –Ω–æ –Ω–∞–π-—á–µ—Å—Ç–æ –∑–∞ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–∞–Ω–µ –Ω–∞ –æ–±–µ–∫—Ç–∏ –∏ —Å–ª–µ–¥ —Ç–æ–≤–∞ —Ñ–∏–ª—Ç—Ä–∏—Ä–∞–Ω–µ –Ω–∞ —Ç–µ–∑–∏, –∫–æ–∏—Ç–æ —Å–∞ `nil`.

```swift
let array = ["1", "2", "üôä"]
let numbers = array.compactMap { Int($0) }
```

–ì–æ—Ä–Ω–∏—è—Ç –ø—Ä–∏–º–µ—Ä —â–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–∞ –µ–ª–µ–º–µ–Ω—Ç–∏—Ç–µ –Ω–∞ –º–∞—Å–∏–≤–∞ –æ—Ç —Å–∏–º–≤–æ–ª–Ω–∏ –Ω–∏–∑–æ–≤–µ –≤ —á–∏—Å–ª–∞, –∞ —Ç–µ–∑–∏, –∫–æ–∏—Ç–æ –Ω–µ —Å–∞ –≤–∞–ª–∏–¥–Ω–∏ —á–∏—Å–ª–∞, —â–µ –±—ä–¥–∞—Ç –∏–∑–∫–ª—é—á–µ–Ω–∏ –æ—Ç —Ä–µ–∑—É–ª—Ç–∞—Ç–∞.
